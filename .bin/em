#!/bin/bash

# Emoji Manager

normalizeString() {
    echo "$1" | tr 'abcdefghijklmnopqrstuvwxyz' 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
}

char2emoji() {
    local letter="$1";
    local offset;
    local a_ascii=65
    local idx;
    local a_emoji=0x1F1E6;

    if [ "$letter" = " " ]; then
        # Space, so add additional spaces to help separate the emojis
        echo "   ";
        return;
    elif [ "$letter" = "?" ]; then
        echo "\U00002754";
        return;
    elif [ "$letter" = "!" ]; then
        echo "\U00002755";
        return;
    elif ! echo "$letter" | grep -q "^[A-Z]$"; then
        echo "$letter";
        return;
    fi

    offset="$(printf "%d" "'$letter")";

    idx=$((offset-a_ascii))

    printf "\\\U000%x" "$((a_emoji+idx))"
}

emojify() {
    local string="$1"
    local char;
    local ret="";

    string="$(normalizeString "$string")"

    for (( i=1; i<=${#string}; i++ )); do
        char="$(printf '%s\n' "$string" | cut -c${i})"

        ret="${ret} $(char2emoji "$char")"
    done

    echo -e "$ret"
}

emojis="$(cat <<EOF
Emojify String

angry livid mad             - ðŸ˜ 
check correct tick          - âœ”
confused                    - ðŸ˜•
cross wrong x               - âŒ
crying                      - ðŸ˜¢
disappointed sad            - ðŸ˜ž
drooling                    - ðŸ¤¤
exclamation mark            - â•
facepalm                    - ðŸ¤¦
fingers crossed             - ðŸ¤ž
fist bump                   - ðŸ¤œðŸ¤›
fist bump distance          - ðŸ¤œ        ðŸ¤›
laugh cry                   - ðŸ˜‚
loudly crying               - ðŸ˜­
middle finger               - ðŸ–•
ok okay perfect             - ðŸ‘Œ
pointing down               - ðŸ‘‡
pointing up                 - ðŸ‘†
poop                        - ðŸ’©
question mark               - â”
sleep zzz boring tired      - ðŸ’¤
thumbs down                 - ðŸ‘Ž
thumbs up                   - ðŸ‘
vulcan salute greetings     - ðŸ––

canada flag                 - ðŸ‡¨ðŸ‡¦
united kingdom flag         - ðŸ‡¬ðŸ‡§
united states american flag - ðŸ‡ºðŸ‡¸

confused                    - ã€Œ(Â°ãƒ˜Â°)
confused shrug              - Â¯\(Â°_o)/Â¯
crying                      - à¼¼ à¼Žàº¶ à·´ à¼Žàº¶à¼½
flipping table              - (â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ â”»â”â”»
happy                       - (âœ¿â— â€¿â— )
i see what you did there    - (Í¡Â° ÍœÊ– Í¡Â°)
middle finger               - (å‡¸à² ç›Šà² )å‡¸
shifty eyes                 - (Â¬ï½¤Â¬)
shrug                       - Â¯\_(ãƒ„)_/Â¯
surprised                   - (ï¾‰ï¾Ÿ0ï¾Ÿ)ï¾‰

degrees                     - Â°
EOF
)"

choice="$(echo -e "$emojis" | dmenu -i -l 20 -c)";

if [ "$choice" = "" ]; then
    exit 0;
elif [ "$choice" = "Emojify String" ]; then
    string="$(echo "" | dmenu -c -i -p "Enter a String: ")";

    if [ "$string" = "" ]; then
        exit 0;
    fi

    toCopy="$(emojify "$string")"
else
    toCopy="$(echo "$choice" | awk -F' *- *' '{ print $2 }')";
fi

echo "$toCopy" | tr -d "\n" | xclip -sel clip;
